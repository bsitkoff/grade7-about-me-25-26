<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ site_title }}</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
            color: #333;
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 40px;
            font-size: 2.5em;
            font-weight: 300;
        }
        
        .section {
            background: white;
            margin: 30px 0;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .section h2 {
            color: #34495e;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #3498db;
            font-size: 1.5em;
            font-weight: 500;
        }
        
        .student-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .student-link {
            display: block;
            padding: 15px;
            text-decoration: none;
            color: #2c3e50;
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            transition: all 0.3s ease;
            text-align: center;
            font-weight: 500;
        }
        
        .student-link:hover {
            background: #3498db;
            color: white;
            border-color: #3498db;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
        }
        
        .student-missing {
            display: block;
            padding: 15px;
            color: #7f8c8d;
            background: #ecf0f1;
            border: 2px solid #bdc3c7;
            border-radius: 8px;
            text-align: center;
            font-style: italic;
        }
        
        .stats {
            text-align: center;
            margin: 40px 0;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .stats h3 {
            color: #2c3e50;
            margin-bottom: 15px;
        }
        
        .stat-item {
            display: inline-block;
            margin: 0 20px;
            text-align: center;
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #3498db;
            display: block;
        }
        
        .stat-label {
            color: #7f8c8d;
            font-size: 0.9em;
        }
        
        .footer {
            text-align: center;
            margin-top: 50px;
            padding: 20px;
            color: #7f8c8d;
            border-top: 1px solid #e9ecef;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .student-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
                gap: 10px;
            }
            
            .stat-item {
                display: block;
                margin: 10px 0;
            }
        }
    </style>
</head>
<body>
    <h1>{{ site_title }}</h1>
    
    {% set total_students = 0 %}
    {% set working_links = 0 %}
    {% set missing_pages = 0 %}
    
    {% for section_name, students in sections %}
        {% set total_students = total_students + students|length %}
        
        <div class="section">
            <h2>Section {{ section_name }}</h2>
            <div class="student-grid">
                {% for student in students %}
                    {% if student.entry_page %}
                        {% set working_links = working_links + 1 %}
                        <a href="{{ pages_base_url }}/{{ student.section }}/{{ student.slug }}/{{ student.entry_page }}" 
                           class="student-link" target="_blank">
                            {{ student.display_name_short }}
                        </a>
                    {% else %}
                        {% set missing_pages = missing_pages + 1 %}
                        <span class="student-missing">
                            {{ student.display_name_short }}<br>
                            <small>Missing index</small>
                        </span>
                    {% endif %}
                {% endfor %}
            </div>
            
            <p style="color: #7f8c8d; margin-top: 15px; font-size: 0.9em;">
                {{ students|length }} students
                {% if students|selectattr("entry_page", "none")|list|length > 0 %}
                    â€¢ {{ students|selectattr("entry_page", "none")|list|length }} missing index pages
                {% endif %}
            </p>
        </div>
    {% endfor %}
    
    <div class="stats">
        <h3>Project Statistics</h3>
        <div class="stat-item">
            <span class="stat-number">{{ total_students }}</span>
            <span class="stat-label">Total Students</span>
        </div>
        <div class="stat-item">
            <span class="stat-number">{{ working_links }}</span>
            <span class="stat-label">Working Projects</span>
        </div>
        {% if missing_pages > 0 %}
        <div class="stat-item">
            <span class="stat-number">{{ missing_pages }}</span>
            <span class="stat-label">Missing Pages</span>
        </div>
        {% endif %}
        <div class="stat-item">
            <span class="stat-number">{{ sections|length }}</span>
            <span class="stat-label">Sections</span>
        </div>
    </div>
    
    <div class="footer">
        <p>Generated on {{ generation_time }}</p>
        <p><strong>Note:</strong> Student names are displayed as "First LastInitial" for privacy.</p>
    </div>
</body>
</html>